# Detect Code Changes Hook

## 목적

코드 변경 시 자동으로 컨텍스트 업데이트 필요 여부를 감지하고 사용자에게 알립니다.

## 동작 방식

### PostToolUse 훅

`Write` 또는 `Edit` 도구 사용 후 자동으로 실행됩니다.

```json
{
  "matcher": {
    "toolName": ["Write", "Edit"]
  },
  "hooks": [{
    "type": "prompt",
    "prompt": "파일 변경 시 컨텍스트 영향 확인..."
  }]
}
```

### 감지 대상

1. **새로운 상수/Magic Number**
   - 상수 선언 추가
   - 리터럴 값 변경

2. **비즈니스 로직 변경**
   - 조건문 변경
   - 유효성 검사 규칙 변경

3. **외부 연동 변경**
   - API 엔드포인트 변경
   - 프로토콜 변경

4. **설계 결정 변경**
   - 라이브러리 변경
   - 아키텍처 패턴 변경

## 사용자 알림

영향이 감지되면 다음과 같이 알립니다:

```
[Context Update 권장]

다음 변경이 CLAUDE.md에 영향을 줄 수 있습니다:
- src/auth/token.rs에 새로운 상수 TOKEN_EXPIRY 추가

'/context-update' 명령으로 컨텍스트를 업데이트할 수 있습니다.
```

## 설계 결정

### 왜 자동 업데이트가 아닌 알림인가?

1. **사용자 통제**: 컨텍스트 변경은 중요한 결정이므로 사용자가 명시적으로 트리거
2. **배치 처리**: 여러 파일 수정 후 한 번에 업데이트하는 것이 효율적
3. **오탐 방지**: 모든 코드 변경이 컨텍스트 영향을 주는 것은 아님

### 왜 PostToolUse인가?

- 파일 변경 직후 즉시 감지 가능
- 변경된 파일 정보에 접근 가능
- 사용자 작업 흐름에 자연스럽게 통합
